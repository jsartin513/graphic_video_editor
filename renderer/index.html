<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Video Merger</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="app-container">
    <header class="app-header">
      <h1>Video Merger</h1>
      <p class="subtitle">Select GoPro video files to merge</p>
    </header>

    <div class="main-content">
      <div class="selection-controls">
        <button id="selectFilesBtn" class="btn btn-primary">
          <span class="btn-icon">üìÅ</span>
          Select Files
        </button>
        <button id="selectFolderBtn" class="btn btn-secondary">
          <span class="btn-icon">üìÇ</span>
          Select Folder
        </button>
      </div>

      <div id="dropZone" class="drop-zone">
        <div class="drop-zone-content">
          <div class="drop-zone-icon">üì§</div>
          <p class="drop-zone-text">Drag and drop video files or folders here</p>
          <p class="drop-zone-hint">or use the buttons above</p>
        </div>
      </div>

      <div id="fileListContainer" class="file-list-container" style="display: none;">
        <div class="file-list-header">
          <h2>Selected Videos</h2>
          <span id="fileCount" class="file-count">0 files</span>
        </div>
        <div id="fileList" class="file-list"></div>
        <div class="file-list-actions">
          <button id="prepareMergeBtn" class="btn btn-primary" style="display: none;">
            <span class="btn-icon">‚ñ∂</span>
            Prepare Merge
          </button>
        </div>
      </div>

      <!-- Preview Screen -->
      <div id="previewScreen" class="preview-screen" style="display: none;">
        <div class="preview-header">
          <h2>Preview Merge</h2>
          <p class="preview-subtitle">Review and edit output filenames before merging</p>
        </div>
        
        <div id="previewList" class="preview-list"></div>
        
        <div class="output-destination-section">
          <label class="output-destination-label">Output Destination:</label>
          <div class="output-destination-controls">
            <div id="outputDestinationDisplay" class="output-destination-display">
              <span id="outputDestinationPath" class="output-destination-path">Using default location (merged_videos subfolder)</span>
            </div>
            <button id="selectOutputDestinationBtn" class="btn btn-secondary btn-small">
              <span class="btn-icon">üìÅ</span>
              Choose Folder
            </button>
            <button id="useDefaultDestinationBtn" class="btn btn-text btn-small" style="display: none;">
              Use Default
            </button>
          </div>
        </div>
        
        <div class="preview-actions">
          <button id="backBtn" class="btn btn-secondary">
            <span class="btn-icon">‚Üê</span>
            Back
          </button>
          <button id="mergeBtn" class="btn btn-primary">
            <span class="btn-icon">üé¨</span>
            Merge Videos
          </button>
        </div>
      </div>

      <!-- Progress Screen -->
      <div id="progressScreen" class="progress-screen" style="display: none;">
        <div class="progress-content">
          <h2>Merging Videos</h2>
          <div class="progress-bar-container">
            <div id="progressBar" class="progress-bar"></div>
          </div>
          <p id="progressText" class="progress-text">Preparing...</p>
          <div id="progressDetails" class="progress-details"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Split Video Modal -->
  <div id="splitVideoModal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Split Video</h2>
        <button id="closeSplitModalBtn" class="modal-close-btn">√ó</button>
      </div>
      <div class="modal-body">
        <div class="split-video-info">
          <p><strong>Video:</strong> <span id="splitVideoName"></span></p>
          <p><strong>Duration:</strong> <span id="splitVideoDuration"></span></p>
        </div>
        
        <div class="split-mode-selector">
          <label>
            <input type="radio" name="splitMode" value="uniform" checked>
            Simple: Split into segments of equal duration
          </label>
        </div>

        <div id="uniformSplitSettings" class="split-settings">
          <div class="form-group">
            <label for="segmentDuration">Duration per segment:</label>
            <div class="duration-input-group">
              <input type="number" id="segmentMinutes" min="1" max="120" value="20" class="duration-input">
              <span class="duration-label">minutes</span>
            </div>
            <p class="form-hint">The video will be split into segments of this duration</p>
          </div>
          
          <div class="split-preview">
            <p><strong>Preview:</strong> <span id="splitPreview">Calculating...</span></p>
          </div>
        </div>

        <div id="splitProgress" class="split-progress" style="display: none;">
          <div class="progress-bar-container">
            <div id="splitProgressBar" class="progress-bar"></div>
          </div>
          <p id="splitProgressText" class="progress-text">Splitting...</p>
        </div>

        <div id="splitResult" class="split-result" style="display: none;"></div>
      </div>
      <div class="modal-footer">
        <button id="cancelSplitBtn" class="btn btn-secondary">Cancel</button>
        <button id="executeSplitBtn" class="btn btn-primary">
          <span class="btn-icon">‚úÇÔ∏è</span>
          Split Video
        </button>
      </div>
    </div>
  </div>

  <!-- Prerequisites Modal -->
  <div id="prerequisitesModal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>‚ö†Ô∏è Prerequisites Required</h2>
      </div>
      <div class="modal-body">
        <p>Video Merger requires <strong>ffmpeg</strong> to merge videos, but it's not installed on your system.</p>
        
        <div id="prerequisitesStatus" class="prerequisites-status">
          <div class="status-item">
            <span id="ffmpegStatus" class="status-icon">‚ùå</span>
            <span>ffmpeg</span>
          </div>
          <div class="status-item">
            <span id="ffprobeStatus" class="status-icon">‚ùå</span>
            <span>ffprobe</span>
          </div>
          <div class="status-item">
            <span id="brewStatus" class="status-icon">‚ùå</span>
            <span>Homebrew</span>
          </div>
        </div>

        <div id="installInstructions" class="install-instructions">
          <h3>Installation Options:</h3>
          <div class="install-option">
            <h4>Option 1: Automatic Installation (Recommended)</h4>
            <p>Click the button below to automatically install ffmpeg using Homebrew.</p>
            <button id="installBtn" class="btn btn-primary">
              <span class="btn-icon">‚¨á</span>
              Install ffmpeg Automatically
            </button>
          </div>
          
          <div class="install-option">
            <h4>Option 2: Manual Installation</h4>
            <p>Open Terminal and run:</p>
            <code class="install-code">brew install ffmpeg</code>
            <p class="install-note">If you don't have Homebrew, install it from <a href="https://brew.sh" target="_blank">brew.sh</a></p>
          </div>

          <div class="install-option">
            <h4>Option 3: Use Installation Script</h4>
            <p>Run the provided installation script:</p>
            <code class="install-code">./install_prerequisites.sh</code>
          </div>
        </div>

        <div id="installProgress" class="install-progress" style="display: none;">
          <div class="progress-bar-container">
            <div id="installProgressBar" class="progress-bar"></div>
          </div>
          <p id="installProgressText" class="progress-text">Installing...</p>
        </div>

        <div id="installResult" class="install-result" style="display: none;"></div>
      </div>
      <div class="modal-footer">
        <button id="checkAgainBtn" class="btn btn-secondary" style="display: none;">
          Check Again
        </button>
        <button id="closeModalBtn" class="btn btn-secondary">
          Continue Anyway
        </button>
      </div>
    </div>
  </div>

  <script type="module" src="renderer.js"></script>
</body>
</html>

